import sys
import paramiko
import re

router_ip = "xxx"
router_username = "xxx"
router_password = "xxx"

ssh = paramiko.SSHClient()

# Load SSH host keys.
ssh.load_system_host_keys()
# Add SSH host key automatically if needed.
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
# Connect to router using username/password authentication.
ssh.connect(router_ip, 
            username=router_username, 
            password=router_password,
            look_for_keys=False )

# Run command.

ssh_stdin, ssh_stdout, ssh_stderr = ssh.exec_command ("show arp")

output = ssh_stdout.readlines()
# Close connection.
ssh.close()
# Finding Mac Address
ip = str(input('Please enter IP address: '))
for line in output:
    if ip in line:
        if result := re.findall("[0-9a-fA-F]{4}[.][0-9a-fA-F]{4}[.][0-9a-fA-F]{4}", line):
            print("Found Mac address:")
            print(result)
        break



        

